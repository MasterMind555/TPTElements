<html>
<head>
  <title>Massive Lua Reference v1.5</title>
  <link rel="stylesheet" href="/ext/css/normalize.css" />
  <link rel="stylesheet" type="text/css" href="../css/style.css" />
  <meta charset="utf-8" />
  <style type="text/css">
  body {
    max-width: 2000px;
  }
  .content {
    white-space: pre;
  }
  </style>
</head>
<body>
<h1>TPTElements - Lua reference</h1>
-- <a href="../index.html">C++ version</a> - <a href="#">Lua version</a> - <a href="../c/">C version</a> - <a href="../reference.html">Reference</a> - <a href="lua-reference.html">Lua reference</a>
-- This is a pretty complete reference of the Powder Toy Lua API. 
-- Comments can be hidden.
-- Use Ctrl+F to find content.
-- <a href="lua-reference.txt">Downloadable textfile</a>
<div class="aside">Options
  <a onclick="toggleComments()" href="javascript:void(0);">- Toggle comments</a>
  <a href="#">- To the top!</a>
  <a href="#treetop">- Treetop</a>
  <a href="#notes">- Notes</a>
  <a href="#tpt">- tpt.*</a>
  <a href="#elements">- elements.*</a>
  <a href="#simulation">- simulation.*</a>
  <a href="#renderer">- renderer.*</a>
  <a href="#graphics">- graphics.*</a>
  <a href="#filesystem">- filesystem.*</a>
  <a href="#interface">- interface.*</a>
  <a href="#bit">- bit.*</a>
  <a href="#boolint">- boolint ?!</a>
  <a href="#properties">- properties</a>
  <a href="#tpt.el">- tpt.el.*</a>
  <a href="#elements.property">- elements.property()</a>
  <a href="#particles">- particles</a>
</div>
<pre><code class="content">
luaref.txt
==========

TPT Lua reference.
Because, frankly, the Wiki pages are not that good.

Meant to be Ctrl+F-ed or just really painstakingly read through.

<span id="notes">Notes</span>
<i>-----</i>

* The tree below is pretty packed with information. The doc has long lines so it
  is suggested that you disable word wrap.
* <b id="boolint">boolint</b> = integer that acts as a boolean (0 or 1)
* <b>number</b> = Lua's natural number type, = "real"
* I'll insert default values or other notes right next to the argument inside 
  brackets <b>[]</b>. 
* <b>d.</b> is short for default. 
* <b>1||2</b> in tpt.setwindowsize means that the correct value is either 1 or 2, 
  nothing else.
* <b>0:255</b> means a value between 0 and 255.
* <b>mixed</b> type means "whatever fits there"
* <b>NYI:</b> Not Yet Implemented
* If not explicitly noted, all color values have limits of <b>0 to 255</b> (incl. firea/r/g/b, cola/r/g/b) and default to white.

<span id="treetop">The Big Tree</span>
<i>------------</i>


(global)
│
│
│  <i id="tpt">-- Legacy Lua API</i>
│  <i>-- Most, if not every, methods here are covered in other APIs. </i>
│  <i>-- Except versions. Those are only accessible here.</i>
├ tpt
│ │
│ ├─ version
│ │  ├─ major <i>-- ex. 81</i>
│ │  ├─ minor <i>-- ex. 0</i>
│ │  └─ build <i>-- ex. 292</i>
│ │
│ ├─ parts [] <i>-- ZERO-INDEXED Array of particles by index </i>
│ │ <i>--           (int type; int life, ctype; float x, y, vx, vy; float temp; </i>
│ │ <i>--           float pavg<b>[2]</b>; int flags; int tmp; int tmp2; unsigned int dcolour)</i>
│ ├─ partsdata = nil <i>-- NYI</i>
│ │
│ ├─ el -- Covered under <a href="#tpt.el">#properties</a> below.
│ │  ├─ dust
│ │  └─ ....
│ │
│ ├─ test                      () <i>-- ??? </i>
│ ├─ nil drawtext              (int x, int y, string text) <i>-- =&gt; Draws a text string for the next frame</i>
│ │      ├─                    (int x, int y, string text, int r, int g, int b)
│ │      └─                    (int x, int y, string text, int r, int g, int b, int a)
│ │
│ ├─ int<b>[index]</b> create         (int x, int y) <i>-- =&gt; Creates a particle</i>
│ ├─ nil/int set_pause         (boolint state) <i>-- =&gt; Sets the game's "paused" state. (1 = paused). -1 returns the paused state.</i>
│ ├─ int toggle_pause          () <i>-- =&gt; set_pause without state</i>
│ ├─ nil set_console           (boolint state) <i>-- =&gt; Opens or closes the console. (1 = open)</i>
│ ├─ nil log                   (string text) <i>-- =&gt; Outputs to the right side of the console. Use for very small values only.</i>
│ ├─ nil set_pressure          (int x, int y, int width, int height, int value) <i>-- Sets pressure for given rectangle. <b>[wall coordinates]</b></i>
│ ├─ nil set_gravity           (int x, int y) <i>-- =&gt; Sets the Newtonian Gravity for a given position. </i>
│ │                            (int x, int y, int width, int height)
│ │                            (int x, int y, int width, int height, int value<b>[d. 0.0]</b>)
│ │
│ ├─ nil reset_gravity_field   (int x, int y) <i>-- =&gt; Sets gravity at (x, y) to 0.0</i>
│ │      └─                    (int x, int y, int width, int height)
│ │
│ ├─ nil reset_velocity        (int x, int y) <i>-- =&gt; Sets velocity at (x, y) to 0.0</i>
│ │      └─                    (int x, int y, int width, int height)
│ │
│ ├─ nil reset_spark           () <i>-- =&gt; Turns all SPRK into its ctype</i>
│ ├─ nil set_property          (string property, mixed value) <i>-- <b>[every element]</b></i>
│ │      ├─                    (string property, mixed value, string type) <i>-- <b>[elements of 1 type]</b></i>
│ │      ├─                    (string property, mixed value, int index) <i>-- <b>[particle via index]</b></i>
│ │      ├─                    (string property, mixed value, int index, string type) <i>-- <b>[???]</b></i>
│ │      ├─                    (string property, mixed value, int x, int y) <i>-- <b>[particle via position]</b></i>
│ │      ├─                    (string property, mixed value, int x, int y, string type) <i>-- <b>[???]</b></i>
│ │      ├─                    (string property, mixed value, int x, int y, int width, int height) <i>-- <b>[region]</b></i>
│ │      └─                    (string property, mixed value, int x, int y, int width, int height, string type) <i>-- <b>[region, filter via type]</b></i>
│ │
│ ├─ mixed get_property        (string property, int index)
│ │        └─                  (string property, int x, int y) 
│ │
│ ├─ nil set_wallmap           (int x, int y, int value) <i>-- =&gt; Set wall at <b>[wall coordinate]</b> x,y</i>
│ │      └─                    (int x, int y, <b>[NYI:int width, int height,]</b> int value)
│ │
│ ├─ int get_wallmap           (int x, int y, <b>[NYI: int width, int height]</b>)   <i>-- =&gt; Get the wall at <b>[wall coordinates!]</b> x, y</i>
│ ├─ nil set_elecmap           (int x, int y, int value) <i>-- =&gt; Sets the sim-&gt;emap value for <b>[wall coordinate]</b> x, y</i>
│ │      └─                    (int x, int y, <b>[NYI:int width, int height,]</b> int value)
│ │
│ ├─ int get_elecmap           (int x, int y) <i>-- =&gt; Returns the sim-&gt;emap value for <b>[wall coordinate]</b> x, y</i>
│ ├─ nil drawpixel             (int x, int y) <i>-- =&gt; Draws a pixel for the next frame</i>
│ │      ├─                    (int x, int y, int r, int g, int b)
│ │      └─                    (int x, int y, int r, int g, int b, int a)
│ │
│ ├─ nil drawrect              (int x, int y, int width, int height) <i>-- =&gt; Draws a hollow rect for the next frame</i>
│ │      ├─                    (int x, int y, int width, int height, int red, int green, int blue)
│ │      └─                    (int x, int y, int width, int height, int red, int green, int blue, int alpha)
│ │
│ ├─ nil fillrect              (int x, int y, int width, int height) <i>-- =&gt; Draws a filled rect for the next frame</i>
│ │      ├─                    (int x, int y, int width, int height, int red, int green, int blue)
│ │      └─                    (int x, int y, int width, int height, int red, int green, int blue, int alpha)
│ │
│ ├─ nil drawline              (int x1, int y1, int x2, int y2) <i>-- =&gt; Draws a line for the next frame</i>
│ │      ├─                    (int x1, int y1, int x2, int y2, int red, int green, int blue)
│ │      └─                    (int x1, int y1, int x2, int y2, int red, int green, int blue, int alpha)
│ │
│ ├─ int textwidth             (string text) <i>-- =&gt; Find out the width of a string of text in the TPT font</i>
│ ├─ string get_name           () <i>-- =&gt; Returns username</i>
│ ├─ nil set_shortcuts         (boolint state) <i>-- =&gt; Enable/Disable key shortcuts</i>
│ ├─ nil delete                (int index) <i>-- =&gt; Delete particle @ position/index</i>
│ │      └─                    (int x, int y)
│ │
│ ├─ nil register_step         (function onTick) <i>-- =&gt; Add a function to be run every tick. Max of 6.</i>
│ ├─ nil unregister_step       (function onTick) <i>-- =&gt; Remove an existing function from running.</i>
│ ├─ nil register_mouseclick   (function onClick) <i>-- =&gt; Add a function to run on mouse click. Arguments: int mousex, int mousey, int button<b>[1:3]</b>, int event</i>
│ ├─ nil unregister_mouseclick (function onClick) <i>-- =&gt; Remove ^.</i>
│ ├─ nil register_keypress     (function onKey) <i>-- =&gt; Add a function to run on keypress. Arguments: char key, int keyCode, int modifierKeys, int event</i>
│ ├─ nil unregister_keypress   (function onKey) <i>-- =&gt; Remove ^.</i>
│ ├─ nil register_mouseevent   <i>-- = register_mouseclick</i>
│ ├─ nil unregister_mouseevent <i>-- = unregister_mouseclick</i>
│ ├─ nil register_keyevent     <i>-- = register_keypress</i>
│ ├─ nil unregister_keyevent   <i>-- = register_keyevent</i>
│ ├─ string input              (string title, string message) <i>-- Input box for values</i>
│ ├─ nil message_box           (string title, string message) <i>-- OK box, same as alert() in Javascript</i>
│ ├─ int get_numOfParts        () <i>-- =&gt; Returns the particle count right now (max: 235008)</i>
│ ├─ nil start_getPartIndex    () <i>-- =&gt; Starts an iteration over particle indexes</i>
│ ├─ bool next_getPartIndex    () <i>-- =&gt; True if there's a particle ID coming up next</i>
│ ├─ int<b>[index]</b> getPartIndex   () <i>-- =&gt; Returns current particle index. USE: tpt.start_getPartIndex() while tpt.next_getPartIndex() do i = tpt.getPartIndex() .... end</i>
│ ├─ nil/int hud               (boolint state) <i>-- =&gt; Show/Hide the HUD. (1 = Show). -1 returns current state.</i>
│ ├─ nil/int newtonian_gravity (boolint state) <i>-- =&gt; Set Newtonian Gravity. (1 = On). -1 returns current state.</i>
│ ├─ nil/int ambient_heat      (boolint state) <i>-- =&gt; Set Ambient Heat. (1 = On) -1 returns current state.</i>
│ ├─ nil/int active_menu       (int menuID)     <i>-- =&gt; Set active menu section. -1 returns current state.</i>
│ ├─ nil/int decorations_enable(boolint state) <i>-- =&gt; Toggle decorations. (1 = On) -1 returns current state.</i>
│ ├─ nil display_mode          (int displayID)  <i>-- =&gt; Set Display mode. </i>
│ ├─ nil throw_error           (string text) <i>-- =&gt; Display an error message.</i>
│ ├─ nil/int heat                  (boolint state) <i>-- =&gt; Toggle Heat. (1 = On) -1 returns current state.</i>
│ ├─ nil setfire               (int strength<b>[=1]</b>) <i>-- =&gt; Set strength of fire effects</i>
│ ├─ nil setdebug              (int level) <i>-- =&gt; Deprecated:  Set debug level. 1 is what D produces. 4 or 5 used to be something awesome.</i>
│ ├─ nil setfpscap             (int maxFPS<b>[=60]</b>) <i>-- =&gt; Set max FPS</i>
│ ├─ nil getscript             (string author, string id) <i>-- =&gt; Fetch a script from the TPT Script Index. The index has no known entries as of 24.07.2013.</i>
│ ├─ nil setwindowsize         (int scale<b>[=1||2, d. 1]</b>, boolint fullscreen<b>[=0]</b>) <i>-- =&gt; Set window size (scaled and fullscreen)</i>
│ ├─ int watertest             () <i>-- =&gt; Toggle water equalization. Returns current state.</i>
│ ├─ nil screenshot            () <i>-- =&gt; Take a screenshot and save it as screenshot_####.png</i>
│ ├─ int/string element        (string element) <i>-- =&gt; Return element ID from string</i>
│ │             └─             (int id) <i>-- =&gt; Return string from element ID</i>
│ │
│ ├─ nil element_func          (int elementID, function onElement) <i>-- =&gt; Make a particle update function. </i>
│ │      │  <i>-- Arguments: int index, int x, int y, int surround_space, int nt. Return: 1 if particle killed</i>
│ │      └─                    (int elementID, function onElement, bool replace) <i>-- =&gt; Replace the previous update function.</i>
│ │
│ └─ nil graphics_func         (int elementID, function onDraw) <i>-- =&gt; Make an element look fancy. </i>
│  <i>-- Arguments: int index, int colr, int colg, int colb. </i>
│  <i>-- Return: boolint cache, int pixel_mode, int cola, int colr, int colg, int colb, int firea, int firer, int fireg, and int fireb.</i>
│ 
│  <i id="elements">-- Elements API</i>
│  <i>-- Everything to do with elements, adding them, modifying them, ...</i>
│  <i>--</i>
│  
├ elements (elem)
│ │ 
│ │ 
│ ├─ TYPE_PART
│ ├─ TYPE_LIQUID
│ ├─ TYPE_SOLID
│ ├─ TYPE_GAS
│ ├─ TYPE_ENERGY
│ │ 
│ ├─ PROP_CONDUCTS
│ ├─ PROP_BLACK
│ ├─ PROP_NEUTPENETRATE
│ ├─ PROP_NEUTABSORB
│ ├─ PROP_NEUTPASS
│ ├─ PROP_DEADLY
│ ├─ PROP_HOT_GLOW
│ ├─ PROP_LIFE
│ ├─ PROP_RADIOACTIVE
│ ├─ PROP_LIFE_DEC
│ ├─ PROP_LIFE_KILL
│ ├─ PROP_LIFE_KILL_DEC
│ ├─ PROP_SPARKSETTLE
│ ├─ PROP_NOAMBHEAT
│ ├─ PROP_DRAWONCTYPE <i>-- Like CLNE, can draw onto it and it'll set the ctype</i>
│ ├─ PROP_NOCTYPEDRAW <i>-- Cannot be drawn as a ctype. Stuff like EMBR are here.</i>
│ │ 
│ ├─ FLAG_STAGNANT
│ ├─ FLAG_SKIPMOVE
│ ├─ FLAG_MOVABLE
│ │ 
│ ├─ ST_NONE
│ ├─ ST_SOLID
│ ├─ ST_LIQUID
│ ├─ ST_GAS
│ │
│ ├─ SC_WALL
│ ├─ SC_ELEC
│ ├─ SC_POWERED
│ ├─ SC_SENSOR
│ ├─ SC_FORCE
│ ├─ SC_EXPLOSIVE
│ ├─ SC_GAS
│ ├─ SC_LIQUID
│ ├─ SC_POWDERS
│ ├─ SC_SOLIDS
│ ├─ SC_NUCLEAR
│ ├─ SC_SPECIAL
│ ├─ SC_LIFE
│ ├─ SC_TOOL
│ ├─ SC_DECO
│ │
│ ├─ DEFAULT_PT_<b>[DUST]</b> <i>-- One for every element. Stores their ID.</i>
│ │
│ ├─ int allocate              (string namespace, string name) <i>-- =&gt; Sets up a space for a new element. Returns new element ID. </i>
│ │  <i>-- Creates key elements.NAMESPACE_PT_NAME for the ID. </i>
│ ├─ nil free                  (int elementID) <i>-- =&gt; Deletes a given element from existence.</i>
│ ├─ nil loadDefault           () <i>-- =&gt; Deletes all new elements. Restores all default elements.</i>
│ ├─ nil/table element         (int elementID) <i>-- =&gt; Returns a table with the element's properties, to modify and set further on</i>
│ │            └─              (int elementID, table properties) <i>-- =&gt; Sets _all_ the properties of an element to ones from the table. Useful for element cloning.</i>
│ └─ nil/mixed property        (int elementID, string property) <i>-- =&gt; Returns an element's single property.</i>
│              └─              (int elementID, string property, mixed value) <i>-- =&gt; Sets an element's single property to value.</i>
│
│  <i id="simulation">-- Simulation API</i>
│  <i>-- Everything to do with particles, pressure, heat, gravity, resetting temperature, whatnot.</i>
│  <i>--</i>
│  
├ simulation (sim)
│ │
│ ├─ table partNeighbours      (int x, int y, int radius) <i>-- =&gt; Find list of particles around center particle, in radius.</i>
│ │        partNeighbors       (int x, int y, int radius, int type)
│ ├─ nil partChangeType        (int index, int type) <i>-- =&gt; Change particle type. Better than setting .type for special cases.</i>
│ ├─ nil partCreate            (int x, int y, int type) <i>-- =&gt; Create a particle. </i>
│ ├─ nil/mixed partProperty    (int index, string field) <i>-- =&gt; Get/set a property on a particle.</i>
│ │            └─              (int index, string field, mixed value) 
│ ├─ int, int partPosition     (int index) <i>-- =&gt; Get x,y from index</i>
│ ├─ int partID                (int x, int y) <i>-- =&gt; Get index from x, y</i>
│ ├─ nil partKill              (int index) <i>-- =&gt; Delete a particle properly</i>
│ │      └─                    (int x, int y)
│ ├─ nil/int pressure          (int x, int y) <i>-- =&gt; Get/set pressure at <b>[wall coordinates]</b> x,y</i>
│ │          ├─                (int x, int y, int value)
│ │          └─                (int x, int y, int width, int height, int value)
│ ├─ nil/int ambientHeat       (int x, int y) <i>-- =&gt; Get/set ambient heat at <b>[wall coordinates]</b> x,y</i>
│ │          ├─                (int x, int y, int value)
│ │          └─                (int x, int y, int width, int height, int value)
│ ├─ nil/int velocityX         (int x, int y) <i>-- =&gt; Get/set velocity (x) at <b>[wall coordinates]</b> x,y</i>
│ │          ├─                (int x, int y, int value)
│ │          └─                (int x, int y, int width, int height, int value)
│ ├─ nil/int velocityY         (int x, int y) <i>-- =&gt; Get/set velocity (y) at <b>[wall coordinates]</b> x,y</i>
│ │          ├─                (int x, int y, int value)
│ │          └─                (int x, int y, int width, int height, int value)
│ ├─ nil/int gravMap           (int x, int y) <i>-- =&gt; Get/set gravity at <b>[wall coordinates]</b> x,y</i>
│ │          ├─                (int x, int y, int value)
│ │          └─                (int x, int y, int width, int height, int value)
│ ├─ int createParts           (int cx, int cy, int rx<b>[=d. 5]</b>, int ry<b>[=d. 5]</b>, 
│ │                             int type<b>[=d. selectedl]</b>, int brush<b>[=d. circle]</b>, int flags<b>[=d. replace flags]</b>) 
│ │                             <i>-- =&gt; Creates multiple particles (like drawing with a brush!) </i>
│ │  <i>-- Set rx and ry to horizontal and vertical radius (ellipse brush). Returns count of affected.</i>
│ ├─ int createLine            (int x1, int y1, int x2, int y2, int rx, int ry, <i>-- =&gt; Create line with createParts. Returns count of affected.</i>
│ │                             int type<b>[=d. selectedl]</b>, int brush<b>[=d. circle]</b>, int flags<b>[=d. replace flags]</b>)
│ ├─ int createBox             (int x1, int y1, int x2, int y2, int type<b>[=d. selectedl]</b>, int flags<b>[=d. replace flags]</b>) <i>-- =&gt; Filled box. Returns count of affected.</i>
│ ├─ int floodParts            (int x, int y, int type, int cm, int flags<b>[=d. replace flags]</b>) <i>-- =&gt; Flood like ctrl+shift+click. Returns count of affected.</i>
│ ├─ int createWalls           (int cx, int cy, int rx<b>[=d. 0]</b>, int ry<b>[=d. 0]</b>, int type<b>[=d. 8]</b>) <i>-- =&gt; Create walls. </i>
│ │  <i>-- (wall types go from right to left, 1 for rightmost not delete). Returns count of affected.</i>
│ ├─ nil createWallLine        (int x1, int y1, int x2, int y2, int rx, int ry, int type<b>[=d. 8]</b>) <i>-- =&gt; Create line with createParts                     </i>
│ ├─ nil createWallBox         (int x1, int y1, int x2, int y2, int type<b>[=d. 8]</b>) <i>-- =&gt; Wall boxes!</i>
│ ├─ int floodWalls            (int x, int y, int type<b>[=d. 8]</b>, int bm) <i>-- =&gt; Flood walls! Returns count of affected.</i>
│ ├─ int toolBrush             (int x, int y, int rx, int ry, int tool, int brush<b>[=d. circle]</b>) <i>-- =&gt; Apply a tool (AIR, VACU, GRAV, HEAT)</i>
│ ├─ nil toolLine              (int x1, int y1, int x2, int y2, int rx, int ry, int tool, int brush<b>[=d. circle]</b>) <i>-- =&gt; Tool brush with line</i>
│ ├─ nil toolBox               (int x1, int y1, int x2, int y2, int tool, float strength<b>[=d. 1.0]</b>) <i>-- =&gt; Tool via box</i>
│ ├─ nil decoBrush             (int x, int y, int rx, int ry, int r, int g, int b, int a, int tool<b>[=d. DECO_DRAW]</b>, int brush<b>[=d. circle]</b>) <i>-- =&gt; Draw decorations</i>
│ ├─ nil decoLine              (int x, int y, int rx, int ry, int r, int g, int b, int a, int tool<b>[=d. DECO_DRAW]</b>, int brush<b>[=d. circle]</b>)
│ ├─ nil decoBox               (int x1, int y1, int x2, int y2, int rx<b>[unused]</b>, int ry<b>[unused]</b>, int r, int g, int b, int a, int tool) <i>-- =&gt; Decorations as a box</i>
│ ├─ nil decoColor             () <i>-- =&gt; Get/Set currently selected deco colour   </i>
│ │  nil decoColour            (int colour<b>[=d. 0xFFFF0000]</b>) <i>-- (0xAARRGGBB)</i>
│ ├─ nil clearSim              () <i>-- =&gt; Clear</i>
│ ├─ nil resetTemp             () <i>-- =&gt; Resets heat of every particle OR every conductor particle (for PTCT/NTCT, metal heating, TUNG, ....)</i>
│ │      └─                    (boolint onlyConductives)
│ │
│ ├─ nil resetPressure         () <i>-- =&gt; Resets pressure everywhere / at x, y / as a box</i>
│ │      ├─                    (int x, int y)  
│ │      └─                    (int x1, int y1, int width, int height)
│ │
│ ├─ string saveStamp          (int x, int y, int width, int height) <i>-- =&gt; Saves a stamp and returns its cryptic name</i>
│ ├─ nil/int loadStamp         (mixed id, int x, int y) <i>-- =&gt; Loads a stamp and places it at x, y. </i>
│ │  <i>-- ID can be char<b>[10]</b> or integer. Note: paused state is ignored! 1 if not OK, nil otherwise.</i>
│ ├─ nil loadSave              (int saveID, int timehistory) <i>-- =&gt; Loads a save or its previous variant at the time (in exact seconds!) it was saved.</i>
│ ├─ nil/int getSaveID         () <i>-- =&gt; Returns the current save's ID.</i>
│ ├─ int, int adjustCoords     (int x, int y) <i>-- =&gt; Translates the coordinates for the zoom window</i>
│ ├─ nil/int prettyPowders     () <i>-- =&gt; Gets/Sets the powder noise thing</i>
│ │          └─                (boolint state)
│ ├─ nil/int gravityGrid       () <i>-- =&gt; Gets/Sets the gravity dot thing</i>
│ │          └─                (boolint state)
│ ├─ nil/int edgeMode          () <i>-- =&gt; Gets/Sets the edge mode. 0 = Void. 1 = Solid.</i>
│ │          └─                (int mode)
│ ├─ nil/int gravityMode       () <i>-- =&gt; Gets/Sets gravity mode. Vertical, Radial, Off, in some order.</i>
│ │          └─                (int mode)
│ ├─ nil/int airMode           () <i>-- =&gt; Gets/Sets the air mode. On, No Velocity, No Pressure, No Update, Off in some order.</i>
│ │          └─                (int mode)
│ ├─ waterEqualisation         () <i>-- =&gt; Gets/Sets water equalization.</i>
│ │  waterEqualization         (boolint state) 
│ ├─ nil/int ambientAirTemp    () <i>-- =&gt; Gets/Sets Ambient Heat mode's air temperature. Default: 293.15</i>
│ │          └─                (int temp)
│ ├─ int elementCount          (int type) <i>-- =&gt; Returns the count of a given particle.</i>
│ ├─ ? parts                   () <i>-- =&gt; ?</i>
│ ├─ ? pmap                    (int x, int y) <i>-- =&gt; Returns particle at (x, y). Same as PartID. </i>
│ └─ neighbours                (int x, int y, int rx, int ry) <i>-- =&gt; ? </i>
│     neighbors
│
│  <i id="renderer">-- Renderer API</i>
│  <i>-- Everything to do with how particles look.</i>
│  <i>--</i>
│  
├ renderer (ren) 
│ │
│ │
│ ├─ PMODE          <i>-- Pixel drawing modes. See http://powdertoy.co.uk/System/External/MediaWiki/images/a/a3/Particle_Drawing_Modes.png</i>
│ ├─ PMODE_NONE     <i>-- Invisible</i>
│ ├─ PMODE_FLAT     <i>-- Regular like Basic view</i>
│ ├─ PMODE_BLOB     <i>-- Blurry like Blob view</i>
│ ├─ PMODE_BLUR     <i>-- Blurry like wtrv</i>
│ ├─ PMODE_GLOW     <i>-- Glowy like PLUT with fancy view</i>
│ ├─ PMODE_SPARK    <i>-- Sparks used to be drawn more fancily</i>
│ ├─ PMODE_FLARE    <i>-- Flare like BOMB</i>
│ ├─ PMODE_LFLARE   <i>-- Large flare like DEST</i>
│ ├─ PMODE_ADD      <i>-- If particles are stacking then adds up the colours</i>
│ ├─ PMODE_BLEND    <i>-- Weaker than the above, does blendy magic.</i>
│ │
│ ├─ PSPEC_STICKMAN <i>-- Only works for STKM, shows them as STKM</i>
│ ├─ OPTIONS        <i>-- </i>
│ ├─ NO_DECO        <i>-- politely refuses decorations be drawn upon it</i>
│ │
│ ├─ DECO_FIRE      <i>-- enables changing the blur colour via deco</i>
│ ├─ FIREMODE       <i>-- </i>
│ ├─ FIRE_ADD       <i>-- A pixel mode that makes it drawn like a fire particle. </i>
│ ├─ FIRE_BLEND     <i>-- ^ with blendy magic.</i>
│ │
│ ├─ EFFECT
│ ├─ EFFECT_GRAVIN  <i>-- Enables what PRTI does, however more life/ctype magic may be needed</i>
│ ├─ EFFECT_GRAVOUT <i>-- ^ for PRTO</i>
│ ├─ EFFECT_LINES
│ ├─ EFFECT_DBGLINES
│ ├─ 
│ ├─ RENDER_EFFE
│ ├─ RENDER_FIRE
│ ├─ RENDER_GLOW
│ ├─ RENDER_BLUR
│ ├─ RENDER_BLOB
│ ├─ RENDER_BASC
│ ├─ RENDER_NONE
│ │
│ ├─ COLOUR_HEAT    <i>-- What particle colors get drawn as. This is like Heat view.</i>
│ ├─ COLOUR_LIFE    <i>-- Like Life display </i>
│ ├─ COLOUR_GRAD    <i>-- Like Heat Gradient display</i>
│ ├─ COLOUR_BASC    <i>-- Like Basic display</i>
│ ├─ COLOUR_DEFAULT <i>-- Default whatever</i>
│ │
│ ├─ DISPLAY_AIRC  
│ ├─ DISPLAY_AIRP   <i>-- Display air pressure</i>
│ ├─ DISPLAY_AIRV   <i>-- Display air velocity</i>
│ ├─ DISPLAY_AIRH   <i>-- Display air heat</i>
│ ├─ DISPLAY_AIR
│ ├─ DISPLAY_WARP   <i>-- Enable gravity wells</i>
│ ├─ DISPLAY_PERS   <i>-- Display Persistent lines</i>
│ ├─ DISPLAY_EFFE
│ │
│ ├─ nil/table renderModes     () <i>-- =&gt; Get/set the render mode table</i>
│ │            └─              (table renderModeTable) 
│ ├─ nil/table displayModes    () <i>-- =&gt; Get/set the display mode table</i>
│ │            └─              (table displayModeTable) 
│ ├─ nil/int colourMode        () <i>-- =&gt; Get/set color mode</i>
│ │  colorMode                 (int colourMode) 
│ ├─ nil/boolint decorations   () <i>-- =&gt; Get or set whether decorations are enabled.</i>
│ │              └─            (boolint state)
│ ├─ nil/int grid              () <i>-- =&gt; Get or set the grid display size</i>
│ │          └─                (int size) 
│ └─ nil/int debugHUD          () <i>-- =&gt; Get/set whether or not debug HUD is visible. Replacement for tpt.setdebug</i>
│            └─                (int level)
│  
│  <i id="graphics">-- Graphics API</i>
│  <i>-- Drawing other stuff onto the screen, like text or boxes.</i>
│  <i>--</i>
│  
├ graphics (gfx)
│ │ 
│ ├─ WIDTH <i>-- =&gt; YRES + MENUSIZE</i>
│ ├─ HEIGHT <i>-- =&gt; XRES + BARSIZE</i>
│ │ 
│ ├─ int textSize              (string text) <i>-- =&gt; Get width of string in TPT font.  </i>
│ ├─ nil drawText              (int x, int y, string text) <i>-- =&gt; Draw text for one frame, every colour value defaults to 255</i>
│ │      └─                    (int x, int y, string text, int r, int g, int b, int a)
│ │ 
│ ├─ nil drawLine              (int x1, int x2, int y1, int y2) <i>-- Draws a line for one frame, colours default to 255</i>
│ │      └─                    (int x1, int y1, int x2, int y2, int r, int g, int b, int a)
│ ├─ nil drawRect              (int x, int y, int width, int height) <i>-- =&gt; Draws a hollow rect for the next frame</i>
│ │      └─                    (int x, int y, int width, int height, int r, int g, int b)
│ ├─ nil fillRect              (int x, int y, int width, int height) <i>-- =&gt; Draws a filled rect for the next frame</i>
│ │      └─                    (int x, int y, int width, int height, int r, int g, int b, int a)
│ ├─ nil drawCircle            (int cx, int cy, int rx, int ry) <i>-- =&gt; Draws an ellipse with two radiuses and a center point</i>
│ │      └─                    (int cx, int cy, int rx, int ry, int r, int g, int b, int a)
│ └─ nil fillCircle            (int cx, int cy, int rx, int ry) <i>-- =&gt; Draws an ellipse with two radiuses and a center point</i>
│        └─                    (int cx, int cy, int rx, int ry, int r, int g, int b, int a)
│ 
│  <i id="filesystem">-- Filesystem API</i>
│  <i>-- Funnest API yet.</i>
│  <i>-- </i>
│  
├ fileSystem (fs)
│ │ 
│ ├─ nil/table list            (string folder) <i>-- =&gt; Lists the contents of a directory, be it other directories or files.</i>
│ ├─ bool exists               (string path)
│ ├─ bool isFile               (string path) 
│ ├─ bool isDirectory          (string path) 
│ ├─ bool makeDirectory        (string path) <i>-- Returns true on success.</i>
│ ├─ bool removeDirectory      (string path) <i>-- Returns true on success.</i>
│ ├─ bool removeFile           (string path) <i>-- Returns true on success.</i>
│ ├─ bool move                 (string path, string newPath)
│ └─ bool copy                 (string path, string newPath)
│ 
│  <i id="interface">-- Interface API</i>
│  <i>-- Oh no. </i>
│  <i>-- If you ever make sense of this you have my congratulations.</i>
│ 
├ interface (ui)
│ │ 
│ ├─ showWindow                (Window w) <i>-- =&gt; Opens a Window.</i>
│ ├─ closeWindow               (Window w) <i>-- =&gt; Closes a Window.</i>
│ ├─ addComponent              (Component c) <i>-- =&gt; Adds a Component to the main window.</i>
│ ├─ removeComponent           (Component c) <i>-- =&gt; Removes a Component from the main window.</i>
│ │  
│ ├─ <b id="interface.Component">Component</b> <i>-- Generic class for utilities</i>
│ │  ├─ nil/bool :visible      () <i>-- Gets/sets whether the component is visible</i>
│ │  │           └─            (bool visible)
│ │  │
│ │  ├─ nil/int,int :size      () <i>-- Gets/sets the component's size</i>
│ │  │              └─         (int width, int height)
│ │  │
│ │  └─ nil/int,int :position  () <i>-- Gets/sets the component's position</i>
│ │                 └─         (int x1, int y1)
│ │ 
│ ├─ <b id="interface.Button">Button</b>
│ │  │
│ │  ├─ Button :new            (int x, int y, int width, int height) <i>-- =&gt; Creates a new button. Event listener needs to be attached later.</i>
│ │  │         └─              (int x, int y, int width, int height, string text, string tooltip)
│ │  ├─ nil :action            (function onClick) <i>-- =&gt; Attaches an event listener. Arguments: Button sender</i>
│ │  ├─ nil/string :text       () <i>-- =&gt; Gets/sets the button's text</i>
│ │  │             └─          (string text) 
│ │  └─ nil/bool :enabled      () <i>-- =&gt; Get/set the button's enabled state</i>
│ │              └─            (bool state) 
│ │
│ ├─ <b id="interface.ProgressBar">ProgressBar</b>
│ │  │
│ │  │
│ │  ├─ ProgressBar :new       (int x, int y, int width, int height, int progress, string status) <i>-- =&gt; Creates a new instance.</i>
│ │  ├─ nil/int :progress      () <i>-- =&gt; Gets/sets the progress bar progress <b>[0:100]</b> -1 makes it scroll right slowly.</i>
│ │  │          └─             (int progress) 
│ │  └─ nil/string :status     () <i>-- =&gt; Gets/sets the progress bar's status text.</i>
│ │                └─          (string status)
│ │ 
│ ├─ <b id="interface.Slider">Slider</b>
│ │  │
│ │  ├─ Slider :new            (int x, int y, int width, int height) <i>-- =&gt; Creates a new instance. Specify the event listener and handler later on.</i>
│ │  ├─ nil :onValueChanged    (function onChange) <i>-- =&gt; Attaches a onChanged event handler. Arguments: sender, value</i>
│ │  ├─ nil/int :value         () <i>-- =&gt; Gets/sets its value. </i>
│ │  │          └─             (int value) 
│ │  └─ nil/int :steps         () <i>-- =&gt; Gets/sets the amount of 'steps' the slider has.</i>
│ │             └─             (int steps) 
│ │ 
│ ├─ <b id="interface.Checkbox">Checkbox</b>
│ │  │
│ │  ├─ Checkbox :new          (int x, int y, int width, int height, <b>[string text = ""]</b>) <i>-- =&gt; Creates a new instance.</i>
│ │  ├─ nil :action            (function onChange) <i>-- =&gt; Arguments: sender, value</i>
│ │  ├─ nil/string :text       () <i>-- =&gt; Gets/sets its text. </i>
│ │  │             └─          (string text) 
│ │  └─ nil/int :checked       () <i>-- =&gt; Gets/sets its checked state. </i>
│ │             └─             (int checked) 
│ │    
│ │ 
│ ├─ <b id="interface.Label">Label</b>
│ │  │
│ │  ├─ Label :new             (int x, int y, int width, int height, <b>[string text = ""]</b>)
│ │  └─ nil/string :text       () <i>-- =&gt; Gets/sets its text. </i>
│ │                └─          (string text) 
│ │    
│ │ 
│ ├─ <b id="interface.Textbox">Textbox</b>
│ │  │
│ │  ├─ Textbox :new           (int x, int y, int width, int height <b>[, string text = "" [, string placeholder = "" ]</b>])
│ │  ├─ nil :onTextChanged     (function onChange) <i>-- =&gt; Arguments: sender</i>
│ │  ├─ nil/bool   :readonly   () <i>-- =&gt; Gets/sets its readonly state. </i>
│ │  │             └─          (string readonly) 
│ │  └─ nil/string :text       () <i>-- =&gt; Gets/sets its text. </i>
│ │                └─          (string text) 
│ │ 
│ │ 
│ └─ <b id="interface.Window">Window</b>
│    │
│    ├─ Window :new            (int x, int y, int width, int height) <i>-- =&gt; A container element for components. Set x/y to -1 to center.</i>
│    │ 
│    ├─ nil :onInitialized     (function func) -- => Function listener for initialization. No arguments.
│    ├─ nil :onTick            (function func) -- => Every tick. No arguments.
│    ├─ nil :onExit            (function func) -- => When the window closes. No arguments.
│    ├─ nil :onTryOkay         (function func) -- => 
│    ├─ nil :onDraw            (function func) -- => When the window is drawn.
│    ├─ nil :onMouseUp         (function func) -- => A: int x, int y, int button
│    ├─ nil :onMouseDown       (function func) -- => A: int x, int y, int button
│    ├─ nil :onMouseMove       (function func) -- => A: int x, int y, int dx, int dy
│    ├─ nil :onMouseWheel      (function func) -- => A: int x, int y, int d
│    ├─ nil :onKeyPress        (function func) -- => A: int key, Uint16 character, bool shift, bool ctrl, bool alt
│    ├─ nil :onKeyRelease      (function func) -- => A: int key, Uint16 character, bool shift, bool ctrl, bool alt
│    ├─ nil :onFocus           (function func) -- => When receives focus. No arguments. 
│    ├─ nil :onBlur            (function func) -- => When loses focus. No arguments.
│    ├─ nil :onTryExit         (function func) -- => When user attempts to exit the window. No arguments.
│    ├─ nil :addComponent      (Component c) <i>-- =&gt; Adds a Component to the Window.</i>
│    └─ nil :removeComponent   (Component c) <i>-- =&gt; Removes a Component from the Window.</i>
│  
│  <i id="bit">-- Bit API</i>
│  <i>-- Because Lua doesn't have one.</i>
│  
└ bit
  │ 
  ├─ int tobit                 (int input) <i>-- =&gt; Normalize for binary operations. Unneeded if you use bit.* functions.s</i>
  ├─ string tohex              (int input, int length) <i>-- =&gt; Generate a hex string from the input.</i>
  │ 
  ├─ int bnot                  (int input) <i>-- =&gt; Performs bitwise NOT (~input)</i>
  ├─ int band                  (int... input) <i>-- =&gt; Performs bitwise AND (input&amp;input) over all arguments.</i>
  ├─ int bor                   (int... input) <i>-- =&gt; Performs bitwise OR (input|input) over all arguments. </i>
  ├─ int bxor                  (int... input) <i>-- =&gt; Performs bitwise XOR (input^input) over all arguments. </i>
  │ 
  ├─ int lshift                (int input, int count) <i>-- =&gt; Performs a leftwards bit shift (input &lt;&lt; count). </i>
  ├─ int rshift                (int input, int count) <i>-- =&gt; Performs a rightwards bit shift (input &gt;&gt; count). </i>
  ├─ int arshift               (int input, int count) <i>-- =&gt; Performs a rightwards arithmetic bit shift (input &gt;&gt;&gt; count). </i>
  │ 
  ├─ int rol                   (int input, int count) <i>-- =&gt; Rotates a bit right by count bits. </i>
  ├─ int ror                   (int input, int count) <i>-- =&gt; Rotates a bit right by count bits. </i>
  │ 
  └─ int bswap                 (int input) <i>-- =&gt; Swaps endianness of the number.</i>







<b id="properties">Properties</b>
----------

An element has many properties as seen above in the tpt.parts[] array definition. 
I've copied the list below for reference.

Elements
~~~~~~~~

* Note: mul stands for multiplier. Used to determine the end result by
  multiplying it to the determined one before application.
* A range [0:x] without a second element [0:] means it can go on however much.

<b id="tpt.el">tpt.el.[inst].*</b>
  │
  ├─ char[4] name 
  ├─ int color          <i> -- 0xAARRGGBB (Element menu uses 0xRRGGBB## !!)</i>
  ├─ float advection    <i> -- [d. 1f:0f] </i>
  ├─ float airdrag      <i> -- [d. 1f:0f] </i>
  ├─ float airloss      <i> -- [d. 1f:0f] </i>
  ├─ float loss         <i> -- [d. 1f:0f] </i>
  ├─ float collision    <i> -- [mul: 0f]</i>
  ├─ float gravity      <i> -- [signed: 0f] </i>
  ├─ float diffusion    <i> -- [mul: 0f]</i>
  ├─ float hotair       <i> -- [mul: 0f]</i>
  ├─ int falldown       <i> -- [0:solid||1:powder||2:liquid]</i>
  ├─ int flammable      <i> -- [d. 0f:]</i>
  ├─ int explosive      <i> -- [0:no||1:fire||2:fire/2.5pressure]</i>
  ├─ boolint meltable   
  ├─ int hardness  
  ├─ boolint menu    
  ├─ boolint enabled 
  ├─ int weight    
  ├─ int menusection 
  ├─ float heat         <i> -- [0f:10000f] in Kelvin (Celsius-273.15)</i>
  ├─ int hconduct       <i> -- [0:250]</i>
  ├─ int state          <i> -- use state constants in elements.ST_* </i>
  ├─ int properties     <i> -- use constants in elements.*</i>
  └─ char * description

<b id="elements.property">elements.property(*</b>
  │
  ├─ string Name
  ├─ int Colour/Color
  ├─ boolint MenuVisible
  ├─ int MenuSection
  ├─ float Advection
  ├─ float AirDrag
  ├─ float AirLoss
  ├─ float Loss
  ├─ float Collision
  ├─ float Gravity
  ├─ float Diffusion
  ├─ float HotAir
  ├─ int Falldown
  ├─ boolint Flammable
  ├─ int Explosive
  ├─ boolint Meltable
  ├─ float Hardness
  ├─ int Weight
  ├─ int Temperature
  ├─ int HeatConduct
  ├─ string Description
  ├─ int State
  ├─ int Properties
  ├─ int LowPressure
  ├─ element LowPressureTransition
  ├─ int HighPressure
  ├─ element HighPressureTransition
  ├─ int LowTemperature
  ├─ element LowTemperatureTransition
  ├─ int HighTemperature
  ├─ element HighTemperatureTransition
  ├─ function Update
  └─ function Graphics  

<b id="particles">Particles</b>
~~~~~~~~~

(particle)
  │
  ├─ int type
  ├─ int life
  ├─ int ctype
  ├─ float x
  ├─ float y
  ├─ float vx
  ├─ float vy
  ├─ float temp
  ├─ float pavg[2]
  ├─ int flags
  ├─ int tmp
  ├─ int tmp2
  └─ unsigned int dcolour


</code></pre>
<script src="../js/jquery-1.9.0.min.js"></script>
<script src="../js/script.js"></script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34425443-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>